{"ast":null,"code":"import _defineProperty from \"/Users/cameronking/Desktop/duke-eats/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/cameronking/Desktop/duke-eats/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/cameronking/Desktop/duke-eats/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/cameronking/Desktop/duke-eats/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/cameronking/Desktop/duke-eats/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/cameronking/Desktop/duke-eats/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/cameronking/Desktop/duke-eats/src/components/Checkout/itemList.js\";\nimport React, { Component } from \"react\";\nimport { withFirebase } from \"../Firebase\";\nimport { Link } from 'react-router-dom';\nimport * as ROUTES from \"../../constants/routes\";\nimport ListItem from \"./item.js\";\nimport { withRouter } from \"react-router-dom\";\n\nvar ItemList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ItemList, _Component);\n\n  function ItemList(props) {\n    var _this;\n\n    _classCallCheck(this, ItemList);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ItemList).call(this, props));\n\n    _this.order = function () {\n      var _this$state = _this.state,\n          name = _this$state.name,\n          uid = _this$state.uid,\n          items = _this$state.items,\n          total = _this$state.total,\n          address = _this$state.address,\n          cardnum = _this$state.cardnum,\n          venmo = _this$state.venmo,\n          location = _this$state.location;\n\n      _this.props.firebase.db.ref(\"/orders/\").push({\n        ordererID: uid,\n        items: items,\n        total: total,\n        location: location,\n        address: address,\n        venmo: venmo,\n        cardnum: cardnum,\n        name: name,\n        status: 'Pending...',\n        delivererID: ''\n      });\n\n      _this.props.firebase.db.ref(\"users/\" + uid).child(\"/cart\").set(null);\n\n      _this.props.history.push(ROUTES.ORDERS);\n    };\n\n    _this.onChange = function (event) {\n      _this.setState(_defineProperty({}, event.target.name, event.target.value));\n    };\n\n    _this.state = {\n      items: [],\n      total: 0,\n      uid: _this.props.firebase.auth.currentUser.uid,\n      address: \"\",\n      venmo: \"\",\n      cardnum: \"\",\n      name: '',\n      location: ''\n    };\n    return _this;\n  }\n\n  _createClass(ItemList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getCardNum();\n      this.getAddress();\n      this.getVenmo();\n      this.getName();\n      this.getCart();\n    }\n  }, {\n    key: \"getCart\",\n    value: function getCart() {\n      var _this$state2 = this.state,\n          items = _this$state2.items,\n          uid = _this$state2.uid,\n          location = _this$state2.location;\n      var self = this;\n      var total = 0;\n      var cartRef = this.props.firebase.db.ref(\"users/\" + uid).child(\"/cart\");\n      cartRef.once(\"value\", function (snapshot) {\n        snapshot.forEach(function (item) {\n          if (location === '') {\n            location = item.val().location;\n            location = location.charAt(0).toUpperCase() + location.slice(1);\n          }\n\n          var name = item.val().name;\n          var price = item.val().price;\n          var quantity = item.val().quantity;\n          var notes = item.val().notes;\n          total += quantity * price;\n          items.push({\n            name: name,\n            price: price,\n            quantity: quantity,\n            notes: notes\n          });\n          self.setState({\n            items: items,\n            total: total,\n            location: location\n          });\n        });\n      });\n    }\n  }, {\n    key: \"getAddress\",\n    value: function getAddress() {\n      var uid = this.state.uid;\n      var self = this;\n      this.props.firebase.user(uid).once(\"value\").then(function (snapshot) {\n        var add = snapshot.val().address;\n        self.setState({\n          address: add\n        });\n      });\n    }\n  }, {\n    key: \"getName\",\n    value: function getName() {\n      var uid = this.state.uid;\n      var self = this;\n      this.props.firebase.user(uid).once(\"value\").then(function (snapshot) {\n        var name = snapshot.val().username;\n        self.setState({\n          name: name\n        });\n      });\n    }\n  }, {\n    key: \"getCardNum\",\n    value: function getCardNum() {\n      var uid = this.state.uid;\n      var self = this;\n      this.props.firebase.user(uid).once(\"value\").then(function (snapshot) {\n        var cN = snapshot.val().cardnum;\n        self.setState({\n          cardnum: cN\n        });\n      });\n    }\n  }, {\n    key: \"getVenmo\",\n    value: function getVenmo() {\n      var uid = this.state.uid;\n      var self = this;\n      this.props.firebase.user(uid).once(\"value\").then(function (snapshot) {\n        var ven = snapshot.val().venmo;\n        self.setState({\n          venmo: ven\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state3 = this.state,\n          items = _this$state3.items,\n          total = _this$state3.total,\n          address = _this$state3.address,\n          venmo = _this$state3.venmo,\n          cardnum = _this$state3.cardnum;\n      var isInvalid = cardnum === '' || address === '' || venmo === '' || items.length === 0;\n      var subtotal = total;\n      var tax = total * 0.075;\n      total = total * 1.075;\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, items.map(function (p) {\n        return React.createElement(ListItem, {\n          ID: p.ID,\n          name: p.name,\n          price: p.price,\n          notes: p.notes,\n          quantity: p.quantity,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141\n          },\n          __self: this\n        });\n      }), items.length === 0 && React.createElement(\"h2\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, \"Cart is empty. :( \"), React.createElement(\"p\", {\n        style: {\n          color: \"white\",\n          paddingBottom: \"0px\",\n          fontFamily: \"Nunito\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"Cart subtotal: $\", subtotal.toFixed(2)), React.createElement(\"p\", {\n        style: {\n          color: \"white\",\n          paddingBottom: \"0px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"Sales tax: $\", tax.toFixed(2)), React.createElement(\"p\", {\n        style: {\n          color: \"white\",\n          paddingBottom: \"0px\",\n          fontWeight: \"bold\",\n          fontSize: \"20px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"Cart total: $\", total.toFixed(2)), React.createElement(\"p\", {\n        style: {\n          fontSize: \"11px\",\n          color: \"white\",\n          paddingBottom: \"0px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \"This total might be slightly different from expected if you made additions or substitutions in the notes. Please check your item notes to ensure they are correct.\"), React.createElement(\"p\", {\n        style: {\n          color: \"white\",\n          fontSize: \"20px\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, \"Check that your info is correct:\"), React.createElement(\"form\", {\n        onSubmit: this.order,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, React.createElement(\"p\", {\n        style: {\n          color: \"white\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"DukeCard Number: \"), React.createElement(\"input\", {\n        name: \"cardnum\",\n        value: cardnum,\n        className: \"form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0\",\n        onChange: this.onChange,\n        type: \"text\",\n        placeholder: cardnum,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        style: {\n          color: \"white\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"Delivery Address: \"), React.createElement(\"input\", {\n        name: \"address\",\n        value: address,\n        className: \"form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0\",\n        onChange: this.onChange,\n        type: \"text\",\n        placeholder: address,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        style: {\n          color: \"white\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, \"Venmo Handle: \"), React.createElement(\"input\", {\n        name: \"venmo\",\n        value: venmo,\n        className: \"form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0\",\n        onChange: this.onChange,\n        type: \"text\",\n        placeholder: venmo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        style: {\n          color: \"white\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, \"When your order is claimed by a deliverer, they will Venmo request the delivery fee of $3.\"), React.createElement(\"button\", {\n        disabled: isInvalid,\n        type: \"submit\",\n        className: \"btn btn-light mx-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, \"Place Order!\"), \"\\xA0\", React.createElement(Link, {\n        to: ROUTES.CART,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-light mx-auto\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195\n        },\n        __self: this\n      }, \"Back\"))));\n    }\n  }]);\n\n  return ItemList;\n}(Component);\n\nexport default withFirebase(withRouter(ItemList));","map":{"version":3,"sources":["/Users/cameronking/Desktop/duke-eats/src/components/Checkout/itemList.js"],"names":["React","Component","withFirebase","Link","ROUTES","ListItem","withRouter","ItemList","props","order","state","name","uid","items","total","address","cardnum","venmo","location","firebase","db","ref","push","ordererID","status","delivererID","child","set","history","ORDERS","onChange","event","setState","target","value","auth","currentUser","getCardNum","getAddress","getVenmo","getName","getCart","self","cartRef","once","snapshot","forEach","item","val","charAt","toUpperCase","slice","price","quantity","notes","user","then","add","username","cN","ven","isInvalid","length","subtotal","tax","map","p","ID","color","paddingBottom","fontFamily","toFixed","fontWeight","fontSize","CART"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { withFirebase } from \"../Firebase\";\nimport { Link } from 'react-router-dom';\nimport * as ROUTES from \"../../constants/routes\";\nimport ListItem from \"./item.js\";\nimport { withRouter } from \"react-router-dom\";\n\nclass ItemList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      items: [],\n      total: 0,\n      uid: this.props.firebase.auth.currentUser.uid,\n      address: \"\",\n      venmo: \"\",\n      cardnum: \"\",\n      name: '',\n      location: ''\n    };\n  }\n\n  componentDidMount() {\n    this.getCardNum();\n    this.getAddress();\n    this.getVenmo();\n    this.getName();\n    this.getCart();\n  }\n\n  getCart() {\n    var { items, uid, location } = this.state;\n    const self = this;\n    var total = 0;\n    var cartRef = this.props.firebase.db.ref(\"users/\" + uid).child(\"/cart\");\n    cartRef.once(\"value\", function(snapshot) {\n      snapshot.forEach(function(item) {\n        if (location === ''){\n          location = item.val().location;\n          location = location.charAt(0).toUpperCase() + location.slice(1);\n        }\n        var name = item.val().name;\n        var price = item.val().price;\n        var quantity = item.val().quantity;\n        var notes = item.val().notes;\n        total += quantity * price;\n        items.push({\n          name: name,\n          price: price,\n          quantity: quantity,\n          notes: notes\n        });\n        self.setState({ items: items, total: total, location: location });\n      });\n    });\n  }\n\n  getAddress() {\n    const { uid } = this.state;\n    const self = this;\n    this.props.firebase\n      .user(uid)\n      .once(\"value\")\n      .then(function(snapshot) {\n        const add = snapshot.val().address;\n        self.setState({ address: add });\n      });\n  }\n\n  getName() {\n    const { uid } = this.state;\n    const self = this;\n    this.props.firebase\n      .user(uid)\n      .once(\"value\")\n      .then(function(snapshot) {\n        const name = snapshot.val().username;\n        self.setState({ name: name });\n      });\n  }\n\n  getCardNum() {\n    const { uid } = this.state;\n    const self = this;\n    this.props.firebase\n      .user(uid)\n      .once(\"value\")\n      .then(function(snapshot) {\n        const cN = snapshot.val().cardnum;\n        self.setState({ cardnum: cN });\n      });\n  }\n\n  getVenmo() {\n    const { uid } = this.state;\n    const self = this;\n    this.props.firebase\n      .user(uid)\n      .once(\"value\")\n      .then(function(snapshot) {\n        const ven = snapshot.val().venmo;\n        self.setState({ venmo: ven });\n      });\n  }\n\n  order = () => {\n    const { name, uid, items, total, address, cardnum, venmo, location } = this.state;\n    this.props.firebase.db.ref(\"/orders/\").push({\n      ordererID: uid,\n      items: items,\n      total: total,\n      location: location,\n      address: address,\n      venmo: venmo,\n      cardnum: cardnum,\n      name: name,\n      status: 'Pending...',\n      delivererID: ''\n    });\n    this.props.firebase.db\n      .ref(\"users/\" + uid)\n      .child(\"/cart\")\n      .set(null);\n    this.props.history.push(ROUTES.ORDERS);\n  };\n\n  onChange = event => {\n    this.setState({ [event.target.name]: event.target.value });\n  };\n\n  render() {\n    var { items, total, address, venmo, cardnum } = this.state;\n    const isInvalid =\n        cardnum === '' || address ==='' || venmo==='' || items.length === 0;\n    const subtotal = total;\n    const tax = total*0.075;\n    total = total*1.075;\n    return (\n      <div>\n        {items.map(p => (\n          <ListItem\n            ID={p.ID}\n            name={p.name}\n            price={p.price}\n            notes={p.notes}\n            quantity={p.quantity}\n          />\n        ))}\n        {items.length === 0 && <h2>Cart is empty. :( </h2>}\n        <p style={{color: \"white\", paddingBottom: \"0px\", fontFamily: \"Nunito\"}}>Cart subtotal: ${subtotal.toFixed(2)}</p>\n        <p style={{color: \"white\", paddingBottom: \"0px\"}}>Sales tax: ${tax.toFixed(2)}</p>\n        <p style={{color: \"white\", paddingBottom: \"0px\", fontWeight: \"bold\", fontSize: \"20px\"}}>Cart total: ${total.toFixed(2)}</p>\n        <p style={{fontSize: \"11px\", color: \"white\", paddingBottom: \"0px\"}}>This total might be slightly different from expected \n          if you made additions or substitutions in the notes. \n          Please check your item notes to ensure they are correct.</p>\n        <p style={{color: \"white\", fontSize: \"20px\"}}>Check that your info is correct:</p>\n        <form onSubmit={this.order}>\n          <p style={{color: \"white\"}}>DukeCard Number: </p>\n          <input\n            name=\"cardnum\"\n            value={cardnum}\n            className=\"form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0\"\n            onChange={this.onChange}\n            type=\"text\"\n            placeholder={cardnum}\n          />\n\n          <p style={{color: \"white\"}}>Delivery Address: </p>\n          <input\n            name=\"address\"\n            value={address}\n            className=\"form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0\"\n            onChange={this.onChange}\n            type=\"text\"\n            placeholder={address}\n          />\n          <p style={{color: \"white\"}}>Venmo Handle: </p>\n          <input\n            name=\"venmo\"\n            value={venmo}\n            className=\"form-control flex-fill mr-0 mr-sm-2 mb-3 mb-sm-0\"\n            onChange={this.onChange}\n            type=\"text\"\n            placeholder={venmo}\n          />\n          <p style={{color: \"white\"}}>When your order is claimed by a deliverer, \n            they will Venmo request the delivery fee of $3.</p>\n          <button\n            disabled={isInvalid}\n            type=\"submit\"\n            className=\"btn btn-light mx-auto\"\n          >\n            Place Order!\n          </button>&nbsp;\n          <Link to={ROUTES.CART}><button type=\"submit\" className=\"btn btn-light mx-auto\">Back</button></Link>\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default withFirebase(withRouter(ItemList));\n"]},"metadata":{},"sourceType":"module"}